<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hidro Forte - EmissÃ£o de CertidÃµes</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
</head>
<body>

    <!-- ======================== TELA DE LOGIN ======================== -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <img src="../../logo.png" alt="Logo Hidro Forte" class="login-logo">
            <h1 class="login-title">Hidro Forte</h1>
            <p class="login-subtitle">EmissÃ£o de CertidÃµes</p>
            <div class="login-form">
                <div class="login-field">
                    <label for="loginUsuario">UsuÃ¡rio</label>
                    <input type="text" id="loginUsuario" placeholder="Digite seu usuÃ¡rio" autocomplete="username">
                </div>
                <div class="login-field">
                    <label for="loginSenha">Senha</label>
                    <input type="password" id="loginSenha" placeholder="Digite sua senha" autocomplete="current-password">
                </div>
                <label class="login-lembrar">
                    <input type="checkbox" id="loginLembrar">
                    <span>Salvar senha</span>
                </label>
                <button class="btn btn-primary login-btn" id="btnLogin" onclick="realizarLogin()">Entrar</button>
                <div class="login-erro" id="loginErro"></div>
            </div>
        </div>
    </div>

    <!-- SIDEBAR -->
    <div class="sidebar" id="appSidebar" style="display:none;">
        <div class="sidebar-logo">
            <img src="../../logo.png" alt="Logo" class="sidebar-logo-img">
            <h2>Hidro Forte</h2>
            <span>EmissÃ£o de CertidÃµes</span>
        </div>
        <div class="sidebar-nav">
            <button class="nav-item active" data-page="emitir" onclick="navigateTo('emitir')">
                <span class="icon">ğŸ“„</span> Emitir CertidÃµes
            </button>
            <button class="nav-item" data-page="relatorio" onclick="navigateTo('relatorio')">
                <span class="icon">ğŸ“Š</span> RelatÃ³rio
            </button>
            <button class="nav-item" data-page="notificacoes" onclick="navigateTo('notificacoes')" id="navNotificacoes" style="display:none;">
                <span class="icon">ğŸ””</span> NotificaÃ§Ãµes
            </button>
            <button class="nav-item" data-page="admin" onclick="navigateTo('admin')" id="navAdmin" style="display:none;">
                <span class="icon">ğŸ‘¤</span> AdministraÃ§Ã£o
            </button>
        </div>
        <div class="sidebar-user" id="sidebarUser">
            <span id="sidebarUserName">UsuÃ¡rio</span>
            <button class="btn-logout" onclick="realizarLogout()" title="Sair">ğŸšª</button>
        </div>
        <div class="sidebar-footer">
            Desenvolvido por Luan Oliveira (63 98144-8181)
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main" id="appMain" style="display:none;">

        <!-- ======================== PÃGINA: EMITIR ======================== -->
        <div class="page active" id="page-emitir">

            <div class="page-header">
                <h1>Emitir CertidÃµes</h1>
                <p>Emita certidÃµes fiscais de forma rÃ¡pida e automatizada</p>
            </div>

            <!-- CNPJ INPUT -->
            <div class="card">
                <div class="card-title">ğŸ” IdentificaÃ§Ã£o</div>
                <div class="input-row">
                    <div class="input-col">
                        <label for="cnpj">CNPJ</label>
                        <input type="text" id="cnpj" placeholder="00.000.000/0000-00" maxlength="18">
                    </div>
                    <button class="btn btn-primary" id="btnBuscarEmpresa" onclick="buscarEmpresa()">Buscar</button>
                </div>
                <div class="empresa-info" id="empresaInfo"></div>
            </div>

            <!-- CERTIDÃ•ES -->
            <div class="card">
                <div class="card-title">ğŸ“„ CertidÃµes DisponÃ­veis</div>
                <div class="certidoes-grid">
                    <div class="cert-card">
                        <div class="cert-icon">ğŸ›ï¸</div>
                        <div class="cert-name">Federal</div>
                        <div class="cert-desc">Receita Federal do Brasil</div>
                        <button class="btn btn-primary btn-sm" onclick="emitirCertidao('federal')">Emitir</button>
                    </div>
                    <div class="cert-card">
                        <div class="cert-icon">ğŸ¢</div>
                        <div class="cert-name">Estadual</div>
                        <div class="cert-desc">SEFAZ Tocantins</div>
                        <button class="btn btn-primary btn-sm" onclick="emitirCertidao('estadual')">Emitir</button>
                    </div>
                    <div class="cert-card">
                        <div class="cert-icon">ğŸ‘·</div>
                        <div class="cert-name">FGTS</div>
                        <div class="cert-desc">Caixa EconÃ´mica Federal</div>
                        <button class="btn btn-primary btn-sm" onclick="emitirCertidao('fgts')">Emitir</button>
                    </div>
                    <div class="cert-card">
                        <div class="cert-icon">âš–ï¸</div>
                        <div class="cert-name">Trabalhista</div>
                        <div class="cert-desc">TST â€” CNDT</div>
                        <button class="btn btn-primary btn-sm" onclick="emitirCertidao('trabalhista')">Emitir</button>
                    </div>
                    <div class="cert-card">
                        <div class="cert-icon">ğŸ˜ï¸</div>
                        <div class="cert-name">Municipal</div>
                        <div class="cert-desc">Prefeitura de Palmas</div>
                        <button class="btn btn-primary btn-sm" onclick="emitirCertidao('palmas')">Emitir</button>
                    </div>
                </div>
                <button class="btn btn-todas" id="btnTodas" onclick="emitirTodas()">
                    ğŸš€ Emitir Todas as CertidÃµes
                </button>
            </div>

            <!-- STATUS / LOG -->
            <div class="card">
                <div class="card-title">ğŸ“Š Status</div>
                <div class="loading-bar" id="loading">
                    <div class="spinner-sm"></div>
                    <span class="loading-text" id="loadingText">Processando...</span>
                </div>
                <div class="log-area" id="log">
                    <div class="log-item info">Aguardando...</div>
                </div>
            </div>
        </div>

        <!-- ======================== PÃGINA: RELATÃ“RIO ======================== -->
        <div class="page" id="page-relatorio">

            <div class="page-header">
                <h1>RelatÃ³rio de CertidÃµes</h1>
                <p>Acompanhe o status e vencimento das certidÃµes emitidas</p>
            </div>

            <!-- STATS + GRÃFICO -->
            <div class="relatorio-top">
                <div class="stats-row" id="statsRow">
                    <div class="stat-card">
                        <div class="stat-label">Total Emitidas</div>
                        <div class="stat-value azul" id="statTotal">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Ativas</div>
                        <div class="stat-value verde" id="statAtivas">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Vencendo em 15 dias</div>
                        <div class="stat-value amarelo" id="statAlerta">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Vencidas</div>
                        <div class="stat-value vermelho" id="statVencidas">0</div>
                    </div>
                </div>

                <div class="grafico-card" id="graficoCard">
                    <div class="grafico-titulo">DistribuiÃ§Ã£o por Status</div>
                    <div class="grafico-container">
                        <canvas id="graficoStatus"></canvas>
                    </div>
                </div>
            </div>

            <!-- SEARCH + TABLE -->
            <div class="card">
                <div class="search-bar">
                    <input type="text" id="searchRelatorio" placeholder="ğŸ” Pesquisar por nome da empresa..." oninput="filtrarRelatorio()">
                    <button class="btn btn-primary btn-sm" onclick="atualizarRelatorio()">ğŸ”„ Atualizar</button>
                    <button class="btn btn-success btn-sm" onclick="abrirPastaCertidoes()">ğŸ“‚ Abrir Pasta</button>
                </div>
                <div class="table-wrapper">
                    <table id="tabelaRelatorio">
                        <thead>
                            <tr>
                                <th onclick="ordenarRelatorio('empresa')" id="th-empresa">Empresa <span class="sort-arrow">â–²</span></th>
                                <th onclick="ordenarRelatorio('tipo')" id="th-tipo">Tipo de CertidÃ£o <span class="sort-arrow">â–²</span></th>
                                <th onclick="ordenarRelatorio('status')" id="th-status">Status <span class="sort-arrow">â–²</span></th>
                                <th onclick="ordenarRelatorio('vencimento')" id="th-vencimento">Data de Vencimento <span class="sort-arrow">â–²</span></th>
                                <th onclick="ordenarRelatorio('dias')" id="th-dias">Dias p/ Vencer <span class="sort-arrow">â–²</span></th>
                                <th>AÃ§Ãµes</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaBody">
                        </tbody>
                    </table>
                </div>
                <div class="empty-state" id="emptyState">
                    <div class="empty-icon">ğŸ“­</div>
                    <p>Nenhuma certidÃ£o registrada</p>
                    <p class="empty-hint">Emita certidÃµes para vÃª-las aqui</p>
                </div>
            </div>
        </div>

        <!-- ======================== PÃGINA: NOTIFICAÃ‡Ã•ES ======================== -->
        <div class="page" id="page-notificacoes">

            <div class="page-header">
                <h1>NotificaÃ§Ãµes por E-mail</h1>
                <p>Configure alertas automÃ¡ticos de vencimento de certidÃµes</p>
            </div>

            <!-- STATUS NOTIFICAÃ‡ÃƒO -->
            <div class="notif-status-bar" id="notifStatusBar" style="display:none;">
                <span id="notifStatusIcon">âœ…</span>
                <span id="notifStatusMsg">Mensagem</span>
            </div>

            <!-- CONFIG E-MAIL -->
            <div class="card">
                <div class="card-title">ğŸ“§ ConfiguraÃ§Ã£o de E-mail</div>
                <div class="notif-form">
                    <div class="notif-row">
                        <div class="notif-field">
                            <label for="emailRemetente">E-mail remetente (Gmail)</label>
                            <input type="email" id="emailRemetente" placeholder="seuemail@gmail.com">
                        </div>
                        <div class="notif-field">
                            <label for="emailSenhaApp">Senha de App (16 caracteres)</label>
                            <input type="password" id="emailSenhaApp" placeholder="xxxx xxxx xxxx xxxx">
                        </div>
                    </div>
                    <div class="notif-row">
                        <div class="notif-field full">
                            <label for="emailDestinatarios">E-mail(s) destinatÃ¡rio(s) <span class="hint">(separe por vÃ­rgula)</span></label>
                            <input type="text" id="emailDestinatarios" placeholder="destino@email.com, outro@email.com">
                        </div>
                    </div>
                    <div class="notif-row">
                        <div class="notif-field">
                            <label for="diasAlerta">Dias antes do vencimento para alertar</label>
                            <input type="number" id="diasAlerta" min="1" max="90" value="15">
                        </div>
                    </div>
                    <div class="notif-row">
                        <label class="notif-toggle">
                            <input type="checkbox" id="notifAtivo" checked>
                            <span>NotificaÃ§Ãµes ativas</span>
                        </label>
                        <label class="notif-toggle">
                            <input type="checkbox" id="notifAoAbrir" checked>
                            <span>Verificar automaticamente ao abrir o app</span>
                        </label>
                    </div>
                </div>
                <div class="notif-actions">
                    <button class="btn btn-primary" onclick="salvarConfigEmail()">ğŸ’¾ Salvar ConfiguraÃ§Ã£o</button>
                    <button class="btn btn-success" onclick="enviarEmailTeste()">ğŸ“¤ Enviar E-mail de Teste</button>
                    <button class="btn btn-todas" onclick="verificarVencimentosAgora()">ğŸ” Verificar Vencimentos Agora</button>
                </div>
            </div>

            <!-- HISTÃ“RICO -->
            <div class="card">
                <div class="card-title">ğŸ“‹ Ãšltima VerificaÃ§Ã£o</div>
                <div id="ultimaVerificacao" class="notif-historico">
                    <p class="empty-hint">Nenhuma verificaÃ§Ã£o realizada ainda</p>
                </div>
            </div>
        </div>

        <!-- ======================== PÃGINA: ADMINISTRAÃ‡ÃƒO ======================== -->
        <div class="page" id="page-admin">

            <div class="page-header">
                <h1>AdministraÃ§Ã£o</h1>
                <p>Gerencie os acessos ao sistema</p>
            </div>

            <!-- CADASTRAR NOVO USUÃRIO -->
            <div class="card">
                <div class="card-title">â• Cadastrar Novo Acesso</div>
                <div class="admin-form">
                    <div class="admin-row">
                        <div class="admin-field">
                            <label for="adminNovoUsuario">UsuÃ¡rio</label>
                            <input type="text" id="adminNovoUsuario" placeholder="Nome de usuÃ¡rio">
                        </div>
                        <div class="admin-field">
                            <label for="adminNovaSenha">Senha</label>
                            <input type="password" id="adminNovaSenha" placeholder="Senha">
                        </div>
                        <div class="admin-field">
                            <label for="adminNovoNivel">NÃ­vel de Acesso</label>
                            <select id="adminNovoNivel">
                                <option value="funcionario">FuncionÃ¡rio</option>
                                <option value="administrador">Administrador</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="cadastrarUsuario()">â• Cadastrar UsuÃ¡rio</button>
                </div>
                <div class="admin-status" id="adminStatus"></div>
            </div>

            <!-- LISTA DE USUÃRIOS -->
            <div class="card">
                <div class="card-title">ğŸ‘¥ UsuÃ¡rios Cadastrados</div>
                <div class="table-wrapper">
                    <table id="tabelaUsuarios">
                        <thead>
                            <tr>
                                <th>UsuÃ¡rio</th>
                                <th>NÃ­vel</th>
                                <th>Criado em</th>
                                <th>AÃ§Ãµes</th>
                            </tr>
                        </thead>
                        <tbody id="tabelaUsuariosBody">
                        </tbody>
                    </table>
                </div>
                <div class="empty-state" id="emptyUsuarios">
                    <div class="empty-icon">ğŸ‘¤</div>
                    <p>Nenhum usuÃ¡rio cadastrado</p>
                </div>
            </div>
        </div>

    </div>

    <!-- MODAL DE CONFIRMAÃ‡ÃƒO DE EXCLUSÃƒO -->
    <div class="modal-overlay" id="modalDeletar">
        <div class="modal-box">
            <h3>ğŸ—‘ï¸ Excluir CertidÃ£o</h3>
            <p id="modalDeletarMsg">Tem certeza que deseja excluir esta certidÃ£o?</p>
            <label class="modal-checkbox">
                <input type="checkbox" id="checkDeletarArquivo">
                TambÃ©m excluir o arquivo PDF do disco
            </label>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="fecharModalDeletar()">Cancelar</button>
                <button class="btn btn-danger" onclick="confirmarDeletar()">Excluir</button>
            </div>
        </div>
    </div>

    <!-- Toast de atualizaÃ§Ã£o automÃ¡tica -->
    <div id="updateToast" class="update-toast oculto">
        <div class="update-toast-content">
            <span id="updateIcon" class="update-toast-icon">ğŸ”„</span>
            <div class="update-toast-text">
                <strong id="updateTitle">Atualizando...</strong>
                <span id="updateMsg"></span>
            </div>
            <div id="updateProgress" class="update-progress oculto">
                <div id="updateProgressBar" class="update-progress-bar"></div>
            </div>
            <button id="btnUpdateRestart" class="btn btn-primary btn-sm oculto" onclick="instalarUpdate()">
                ğŸ” Reiniciar Agora
            </button>
            <button class="update-toast-close" onclick="fecharUpdateToast()">âœ•</button>
        </div>
    </div>

    <script src="renderer.js"></script>
</body>
</html>
